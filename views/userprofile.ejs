<% include header.ejs %>
<div class="container" style="margin-top: 5rem">

    <div class="jumbotron">
        <em class="lead quote-font" id="quotes"></em>
        <footer class="blockquote-footer" id="author"></footer>
    </div>
    
  <div class="row">
    <div class="col-lg-12">
      <%if (message && message.length > 0){%>
        <div class="alert alert-info">
          <%=message%>
        </div>
      <%}%>
    </div>
  </div>
  <div class="row border">
    <div class="col-lg-12 text-center" style="margin-bottom: 20px;">
        <h1><%= user.username %></h1>
    </div>
    <div class="col-lg-4">
      
      <p>Number of questions asked:<span class="badge badge-secondary"><%= user.questions.length %></span></p>
      <p>Number of answers: <span class="badge badge-secondary"><%= user.answers.length %></span></p>
    </div>
    <div class="col-lg-4">
      <!-- Empty div -->
    </div>
    <div class="col-lg-4">
        <% if (currentUser && currentUser.username == user.username){ %>        
          <% if (!currentUser.profile.isHidden){ %>          
            <form action="/hideprofile/<%=user._id%>" method="POST">
              <button type="submit" id="hideProfile" class="btn btn-sm btn-primary">Hide Profile</button>
            </form>
          <% } else if (currentUser.profile.isHidden){ %>
            <form action="/unhideprofile/<%=user._id%>" method="POST">
              <button type="submit" id="hideProfile" class="btn btn-sm btn-primary">Unhide Profile</button>
            </form>
          <% } %>
          
        <% } %>
        
    </div>
  </div>


  <br>
  
  
 <div class="row" style="height: 100%;">
	 <div class="col-lg-2">
	  	<h6>Feed</h6>
	  	<hr>
      <div class="nav flex-column nav-pills" id="v-pills-tab" role="tablist" aria-orientation="vertical">
          <a class="nav-link active" id="v-pills-questions-tab" data-toggle="pill" href="#v-pills-questions" role="tab" aria-controls="v-pills-questions" aria-selected="true">Questions</a>
          <a class="nav-link" id="v-pills-answers-tab" data-toggle="pill" href="#v-pills-answers" role="tab" aria-controls="v-pills-answers" aria-selected="false">Answers</a>
          <a class="nav-link" id="v-pills-questionFollows-tab" data-toggle="pill" href="#v-pills-questionFollows" role="tab" aria-controls="v-pills-questionFollows" aria-selected="false">Following</a>
        </div>
	</div>
  <div class="col-lg-10" id="activityContainer">
    	<h6 id="activity">List</h6>
      <hr>
      

      <div class="tab-content" id="v-pills-tabContent">
          <div class="tab-pane fade show active" id="v-pills-questions" role="tabpanel" aria-labelledby="v-pills-questions-tab">
              <ul class="list-group">
                  <% for (i = 0; i < user.questions.length ; i++){ %>
                      <a href="/question/<%=user.questions[i]._id%>" class="list-group-item list-group-item-action"><%=user.questions[i].question.charAt(0).toUpperCase() + user.questions[i].question.slice(1) %></a>
                  <% } %>
                </ul>
          </div>
          <div class="tab-pane fade" id="v-pills-answers" role="tabpanel" aria-labelledby="v-pills-answers-tab">
              <ul class="list-group">
                  <% for (i = 0; i < user.answers.length ; i++){ %>
                    <li class="list-group-item">
                      <a href="/question/<%= user.answers[i].questionId%>" class="text-dark">
                        <h5><%= user.answers[i].questionText.charAt(0).toUpperCase() + user.answers[i].questionText.slice(1) %></h5>
                      </a>
                      <p>
                        <strong><%= user.username %>'s answer:&nbsp</strong><%= user.answers[i].answer.charAt(0).toUpperCase() + user.answers[i].answer.slice(1) %> 
                      <p>
                    </li>
                  <% } %>
                </ul>
          </div>
          <div class="tab-pane fade" id="v-pills-questionFollows" role="tabpanel" aria-labelledby="v-pills-answers-tab">
            <ul class="list-group">
              <% for (i = 0; i < user.followedQuestions.length ; i++){ %>
                  <a href="/question/<%=user.followedQuestions[i]._id%>" class="list-group-item list-group-item-action"><%=user.followedQuestions[i].question.charAt(0).toUpperCase() + user.followedQuestions[i].question.slice(1) %></a>
              <% } %>
            </ul>
          </div>
        </div>
    
    
  </div>
  </div>
</div>




<script>
$(document).ready(function() {

  $("#changeEmailInput").hide();

    $("#changeEmail").on("click", function(){
      $("#changeEmail").hide();
      $("#changeEmailInput").show();
      $("#hideProfile").hide();
    });

    $("#changeEmailCancel").on("click", function(){
      $("#changeEmailInput").hide();
      $("#changeEmail").show();
      $("#hideProfile").show();
    });

    $.get( "https://api.mlab.com/api/1/databases/templo/collections/motivationalquotes?apiKey=zJZdthm4HNnURfvKlosWFVCMyAkSjF88", function(quotes) {
      
  
      var initialQuote =  Math.floor((Math.random() * (quotes.length)));
      $("#quotes").html(quotes[initialQuote].quote); 
      $("#author").html(quotes[initialQuote].author);
      
         
       function newQuote(){
           i = Math.floor((Math.random() * (quotes.length)));
           $("#quotes").fadeOut(2000, function(){
             $("#quotes").fadeIn(2000)
             $("#quotes").html(quotes[i].quote);
           });
           $("#author").fadeOut(2000, function(){
             $("#author").fadeIn(2000)
             $("#author").html(quotes[i].author);
           });
           
         }
   
         setInterval(newQuote, 20000);
      });
  
});
</script>









<% include footer.ejs %>